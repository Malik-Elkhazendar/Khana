<header class="app-header" role="banner">
  <div class="header-inner">
    <a
      class="brand"
      routerLink="/dashboard/bookings"
      [attr.aria-label]="'DASHBOARD.NAV.BRAND_LABEL' | translate"
      (click)="onNavClick()"
    >
      Khana
    </a>

    <nav
      class="primary-nav"
      role="navigation"
      [attr.aria-label]="'DASHBOARD.NAV.PRIMARY_NAVIGATION' | translate"
    >
      <ul class="nav-list">
        <li
          class="nav-item"
          *ngFor="let item of navItems; trackBy: trackByRoute"
        >
          <a
            class="nav-link"
            [routerLink]="item.route"
            routerLinkActive="nav-link--active"
            [routerLinkActiveOptions]="{ exact: item.exact }"
            (click)="onNavClick()"
          >
            <app-ui-icon
              class="nav-link__icon"
              [name]="item.icon"
            ></app-ui-icon>
            <span>{{ item.labelKey | translate }}</span>
          </a>
        </li>
      </ul>
    </nav>

    <div class="header-actions">
      <app-language-switcher
        tone="dark"
        [useShortLabel]="true"
      ></app-language-switcher>

      <button
        class="menu-toggle"
        type="button"
        [attr.aria-label]="'DASHBOARD.NAV.TOGGLE_NAVIGATION' | translate"
        [attr.aria-expanded]="mobileDrawerOpen()"
        (click)="toggleMobileMenu()"
      >
        <span class="menu-icon" aria-hidden="true">
          <span class="menu-bar"></span>
          <span class="menu-bar"></span>
          <span class="menu-bar"></span>
        </span>
      </button>

      <div class="user-area" *ngIf="currentUser() as user; else guestUser">
        <button
          class="user-button"
          type="button"
          [attr.aria-label]="'DASHBOARD.NAV.TOGGLE_USER_MENU' | translate"
          aria-haspopup="menu"
          [attr.aria-expanded]="userMenuOpen()"
          [attr.aria-controls]="userMenuId"
          (click)="toggleUserMenu()"
        >
          <span class="user-avatar" aria-hidden="true">
            {{ user.name ? user.name.slice(0, 1) : '' }}
          </span>
          <span class="user-info">
            <span class="user-name">{{ user.name }}</span>
            <span class="user-role">{{ user.role }}</span>
          </span>
          <span class="user-caret" aria-hidden="true"></span>
        </button>

        <div
          class="user-menu"
          *ngIf="userMenuOpen()"
          role="menu"
          [attr.id]="userMenuId"
        >
          <button
            class="user-menu__item"
            type="button"
            role="menuitem"
            (click)="logout()"
          >
            {{ 'DASHBOARD.USER.LOGOUT' | translate }}
          </button>
        </div>
      </div>

      <ng-template #guestUser>
        <a
          class="user-button user-button--ghost"
          routerLink="/login"
          (click)="onNavClick()"
        >
          {{ 'DASHBOARD.USER.SIGN_IN' | translate }}
        </a>
      </ng-template>
    </div>
  </div>
</header>
